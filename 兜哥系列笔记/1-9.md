# 支持向量机算法

​	支持向量机是分类算法里面使用范围最为广泛的算法之一。它广泛地应用在生活中的众多领域，基本上所有的分类问题，尤其是二分类问题，都可以先用它试下。

## 9.1 支持向量机算法概述

​	支持向量机是机器学习领域使用最广泛的算法之一，通常用来进行模式识别、分类以及回归分析，它特别适合安全世界里面的非黑即白。

​	假设分类问题可以线性区分，那么这个区分的直线称为超平面，距离超平面最近的样本称为支持向量。

​	对于不可线性区分的情况，需要依靠核函数升级到更高的平面进行区分。

​	选择不同的核函数，可以生成不同的SVM，常用的核函数有：

- 线性核函数
- 多项式核函数
- 径向基函数
- 二层神经网络核函数

## 9.2 支持向量机示例

```python
import numpy as np
import matplotlib.pyplot as plt
from sklearn import svm

# we create 40 separable points
np.random.seed(0)
X = np.r_[np.random.randn(20, 2) - [2, 2], np.random.randn(20, 2) + [2, 2]]
Y = [0] * 20 + [1] * 20

# fit the model
clf = svm.SVC(kernel='linear')
clf.fit(X, Y)
```

## 9.3 使用支持向量机算法识别XSS示例

1. 处理流程

   数据清洗->数据标记->特征化->数据拆分->(训练数据、测试数据)

2. 数据收集和数据清洗

   参考 《基于WAVSEP》的靶场搭建指南

3. 特征化

   通常需要对特征进行标准化，常见方式：

   - 标准化；
   - 均方差缩放；
   - 去均值。

   Web日志特征化：（url长度，url中包含第三方域名的个数，敏感字符的个数，敏感关键字的个数）

## 9.4 使用支持向量机算法区分僵尸网络DGA家族示例

### 9.4.1 实验阶段，我们搜集如下数据

- 1000个cryptolocker域名；
- 1000个post-tovar-goz域名；
- alexa前1000域名。

### 9.4.2 特征化

1. 元音字母个数

   正常人通常在取域名的时候，都会偏向选取“好读”的几个字母组合，抽象成数学可以理解的语言，这使英文的元音字母比例会比较高。

2. 去重后的字母数字个数与域名长度的比例

   去重后的字母数字个数与域名长度的比例，从某种程度上反映了域名字符组成的统计特征。

3. 平均jarccard系数

   jarccard系数定义为两个集合与并集元素个数的比值，本例的jarcard系数是基于2-gram计算的

4. hmm系数

   正常人通常在取域名的时候，都会偏向选取常见的几个单词组合，抽象成数学可以理解的语言，因此，以常见英文单词训练hmm模型，正常域名的hmm系数偏高，僵尸网络DGA域名由于是随机生成的，所以hmm系数偏低

