# 循环神经网络算法

​	循环神经网络算法通过特殊的结构使得自身具有了记忆性，可以使用记忆更好地进行判断，因此在自然语言处理、信号处理、情感识别等领域具有广泛应用。

## 16.1 循环神经网络算法概述

​	RNN之所以成为循环神经网络，是因为一个序列当前的输出与前面的输出有关。

​	理论上RNN能够对任何长度的序列数据进行处理。但是在时间中，为了降低复杂性往往假设当前的状态只与前面的几个状态有关。

​	把RNN神经元展开来分析，RNN等效于一连串共享系数的神经元串联在一起，这也就解释了RNN特别适合处理时序数据的原因。

​	在比较复杂的情况下，只分析时序数据的最近几个数据是难以得到合理结果的，需要更长的记忆来追根溯源，于是就有了LSTM，可以再更长的时间范围内分析时序数据

## 16.2 识别验证码

1. 数据清洗与特征化

   MNIST数据集，可以利用TFLearn提供的API来获取MNIST数据集。

   特征化为：连续28个维度28的特征向量序列。

## 16.3 识别恶意评论示例

 1. 数据清洗与特征化

    Moive Review Data数据集。包含1000条正面评论，1000条负面评论。

    使用词袋模型将文本向量化。

 2. 训练样本

    RNN特别适合检测时序型数据，所以需要将评论转换成时序数据，截取文件的前100个单词作为一个序列，每个单词由于词袋模型进行编码，标记数据使用one-hot编码。

    构造RNN网络，输入层长度为100，embedding输入的数据维度为词袋 的词汇表的长度n_words，输出的数据维度定义为128，LSTM层随机刷选80%的数据传递给下一层。

    全连接层激活函数使用softmax函数，输出数据维度为2，优化使用adam算法，学习速率为0.001

## 16.4 生成城市名称示例

​	RNN具有记忆性，在经过大量训练后可以学习到时序数据的潜在规律，并且可以使用这种规律随机生成新的序列。

## 16.5 识别WebShell示例

1. 数据清洗与特征化

   ADFA-LD 数据集中关于WebShell的数据进行试验。（系统调用情况）

## 16.6 生成常用密码示例

1. 数据清洗与特征化

   使用WVS自带的密码字典作为训练集



## 16.7 识别异常操作示例

​	黑客入侵Web服务器后，通常会通过系统漏洞进一步提权，获得root权限，内部员工的违规操作同样也可能造成巨大危害。我们试图通过搜集Linux服务器的bash操作日志，通过训练识别出特定用户的操作习惯，然后进一步识别出异常操作行为。

1. 数据清洗与特征化

   SEA数据集涵盖70多个UNIX系统用户的行为日志。

   每100个命令组成一个向量

   把每个命令当成一个单词，使用词集模型进行处理

   使用生成词集的词汇表对操作命令进行编码，将操作命令序列化