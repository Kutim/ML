# Web安全基础

## 4.1 XSS

XSS的危害：

- 盗取各类用户账号，如机器登录账号、用户网银账号、各类管理员账号；
- 控制企业数据，包括读取、篡改、添加、删除企业敏感数据的能力；
- 盗取企业重要的具有商业价值的资料；
- 非法转账；
- 强制发送电子邮件；
- 网站挂马；
- 控制受害者机器向其他网站发起攻击。

### 4.1.1 XSS的分类

1. 反射性XSS（非持久型XSS）

   Payload一般卸载URL中，之后设法让被害者点击这个链接。

   ```php
   <?php
   	$username = $_GET['username'];
   	echo $username;
   >
   攻击链接为：
       http://XXXXX?username=<script>alert(/xss/)</script>
   ```

   

2. 存储型XSS（持久型XSS）

   存储型XSS被服务器端接收兵存储，当用户访问该网页时，这段XSS代码被读出来响应给浏览器。反射型XSS与DOM型XSS都必须依靠用户手动触发，而存储型XSS却不需要。

3. DOM型XSS

   基于DOM型的XSS是不需要与服务器交互的，它只发生在客户端处理数据阶段。简单理解DOM XSS就是出现在 JavaScript 代码中的XSS漏洞



DOM型XSS是前端代码中存在了漏洞，而反射型XSS是后端代码中存在了漏洞。

反射型和存储型XSS都是服务器端代码漏洞造成的。

### 4.1.2 XSS特殊攻击方式

利用js的特性进行特殊编码变形绕过防御的手段

1. Jsfuck(http://www.jsfuck.com/)

   可以针对常见的js 函数、语法进行编码转换。

2. Aaencode(http://utf-8.jp/public/aaencode.html)

   js 加密工具aaencode把js转为文字表情符号。

3. jjencode（http://utf-8.jp/public/jjencode.html）

### 4.1.3 XSS 平台

市面上有大量XSS平台，自动生成js攻击载荷

- 注册平台账号
- 获取XSS攻击代码，主要功能是获取用户cookie、ua、ip 等信息
- 结合XSS漏洞构造恶意链接

http://webxss.top/

## 4.2 SQL注入

SQL注入，就是通过把SQL命令插入到Web表单提交或输入域名或页面请求的查询字符串，最终达到欺骗服务器执行恶意SQL命令。

### 4.2.1 常见SQL注入攻击

1. 强制产生错误

   收集数据库类型、版本等信息，为其他类型攻击做准备。利用应用程序服务器返回的默认错误信息而取得漏洞信息。

2. 采用非主流通道技术

   除HTTP响应外，还能通过通道获取数据（依赖数据库支持的功能）。SQL注入的非主流通道主要有E-mail、DNS以及数据库连接，基本思想为：先对SQL查询打包，然后借助非主流通道将信息反馈至攻击者。

3. 使用特殊字符

   

4. 使用条件语句

   具体方式可分为：基于内容、基于时间、基于错误。

5. 利用存储过程

   通过某些标准存储过程，数据库厂商在对数据库的功能进行扩展的同时，操作系统也可以与数据库进行交互。

6. 避开输入过滤技术

   技术手段包括：SQL注释和动态查询的使用，利用截断，URL编码与空字节的使用，大小写变种的使用，以及嵌套剥离后的表达式等等。

7. 推断技术

   该技术能够明确数据库模式、提取数据以及识别可注入参数。此种方式的攻击通过网站，对用户输入的反馈信息、可注入参数、数据库模式等进行推断。

   时间测定注入、盲注入。

### 4.2.3 SQL常见工具

1. sqlmap

   可以搭建 WAVSEP 靶场

2. HAVIJ

   自动化SQL注入工具

## 4.3 WebShell

WebShell 就是以ASP、PHP、JSP或者CGI等网页文件形式存在的一种命令行执行环境，也可以将其称为一种网页后门。

### 4.3.1 WebShell 功能

WebShell 通常具备以下功能：

- 环境探针
- 资源管理
- 文件编辑
- 执行OS命令
- 读取注册表
- 创建Socket
- 调用系统组件

## 4.4 僵尸网络

指采用一种或多种传播手段，使大量主机感染bot程序病毒，从而在控制者和被感染主机之间所形成的一个可一对多控制的网络。

### 4.4.1 僵尸网络的危害

1. 拒绝服务攻击
2. 发送垃圾邮件
3. 窃取秘密
4. 滥用资源
5. 僵尸网络挖矿

